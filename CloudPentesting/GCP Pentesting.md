Organization
	--> Folders
		--> Projects
			--> Resources
			
**Organization** : The Organization resource is the root node in the Google Cloud resource hierarchy and is the hierarchical super node of projects.

**Folders** : Folders are nodes in the Cloud Platform Resource Hierarchy. A folder can contain projects, other folders, or a combination of both.

Organizations can use folders to group projects under the organization node in a hierarchy.

**Project** : A GCP Project is basically a collection of various GCP services such as compute instances, storage buckets, Cloud run containers, etc. that are grouped together since they serve one application or project in the corporate terminology.

### GCP Service Account
Equivalent to role in AWS and Managed Identities in Azure. By default service account never expire and did not have MFA. Very interesting account for attackers.

A service account is a special kind of account used by an application or GCP compute instance.

Service account act as a identity as well as a resource: - Service account as identity - Where we need GCP resource access without human intervention - Service account as resource - Where we need access on other service accounts –> Service account is associated within a project and uniquely identity by it’s email address.


### Default Service Account
- Automatically created within a project (Ex: User create a new compute instance)
	– App Engine: Default Service Account: PROJECT_ID@appspot.gserviceaccount.com
	– Compute Engine: Default Service Account: PROJECT_NUMBER-compute@developer.gserviceaccount.com

>The Compute Engine default service account is created with the IAM basic Editor role. They have this permission on Project level.


**User Managed Service Account** : 
- Created and managed by end user when required :  SERVICE_ACCOUNT_NAME@PROJECT_ID.iam.gserviceaccount.com

To view their permissions you can copy theses managed service account role to a custom one. `gcloud iam roles copy`


**GCloud CLI**
• https://cloud.google.com/sdk/docs/cheatsheet –> Google Cloud CLI is aset of tools to create and manage Google Cloud resources. Through click on the web console or GCloud CLI you will directly talk to Control Plan APIs (Restfull).

Obtaining User Access Tokens
As mentionned previously 2 types of accounts exist within GCP : - User accounts (user credentials) - Service accounts (service account credentials)

Secret in user credentials files takes the form of a long-lived refresh tokens .

–> You usually obtain (authorized) user credential files by through the underly- ing command, which initiates an OAuth 2.0 authorization code grant. `gcloud auth application-default login`
–> This will produce a credential file called : `application_default_credentials.json`
–> Located at : `~/.config/gcloud`
This refresh token can be used to obain access tokens using OAuth 2.0 refresh token grant.

As an attacker some actions or tools required an access tokens to operate. In fact the refresh token grant action only requires a single call to retrieve a valid access token.
```
curl --location --request POST "https://oauth2.googleapis.com/token" --header "Content-Type:
'client_id': 'XXXXXXXXXX-XXXXXXXXXXXX.apps.googleusercontent.com',
'client_secret': 'X-XXXXXXXXXXXXXXXX',
'refresh_token': 'XXXXXXXXXXXXXXXXXXXXXXXXXX',
'grant_type': 'refresh_token'
}"
```
–> The response is an access token and an ID token.
Note 1 : You can modify the access token scopes by specifying scopes in your request, although you cannot increase beyond the scopes of the original refresh token.
Note 2 : The scope ending cloud-platform gives you access to pretty much all GCP resources.

### Overview of GCP Penetration Testing Methodologies

Google Cloud Platform (GCP) penetration testing involves simulating cyberattacks to uncover vulnerabilities, misconfigurations, and security gaps in cloud environments. This is essential for organizations using GCP services like Compute Engine, Cloud Storage, IAM, and VPCs, under the shared responsibility model where Google secures the infrastructure, and customers handle configuration and data security. Unlike traditional on-prem testing, GCP pentesting emphasizes API interactions, identity management, and cloud-native features, often combining automated scans with manual exploitation to mimic real-world threats. Always conduct this ethically with permission, following Google's penetration testing guidelines, which permit certain activities without prior notification for services like App Engine and Compute Engine.

Methodologies are inspired by standards like PTES (Penetration Testing Execution Standard), CIS Benchmarks for GCP, and Google's Well-Architected Framework. Approaches can be black-box (no prior knowledge), gray-box (limited info), or white-box (full access), focusing on external reviews, internal simulations, or configuration audits.

### Key Phases in GCP Pentesting Methodologies

A typical GCP pentest follows a structured process to ensure comprehensive coverage:

1. **Planning and Scoping**: Define objectives, identify the attack surface (e.g., specific projects, regions, or services), and align with compliance needs. This includes reviewing the shared responsibility model and obtaining necessary approvals.

2. **Reconnaissance and Enumeration**: Gather intelligence on exposed resources, such as public buckets, APIs, or instances. This involves passive discovery of assets without direct interaction.

3. **Vulnerability Assessment**: Scan for misconfigurations, like overly permissive IAM roles or open firewall rules. Assess services for common issues in storage, networking, and identity.

4. **Exploitation and Post-Exploitation**: Simulate attacks to demonstrate impact, such as privilege escalation via IAM or lateral movement across projects, while avoiding disruption.

5. **Reporting and Remediation**: Document findings with risk levels, proof-of-concepts, and recommendations, such as enabling MFA or using least-privilege policies.

### Common Testing Approaches

Below is a table summarizing key approaches from various guides, tailored to GCP environments:

| Approach | Description | Focus Areas | Example Use Cases |
|----------|-------------|-------------|-------------------|
| **External Posture Review** | Simulates an outsider's view, testing public-facing assets without credentials. | Exposed APIs, public storage buckets, perimeter defenses | Identifying data leaks or weak external configurations. |
| **Configuration Audit** | Non-invasive review of setups against best practices and benchmarks. | IAM policies, VPC firewall rules, encryption settings | Compliance checks or pre-deployment assessments. |
| **Internal Dynamic Testing** | Assumes initial compromise and explores escalation paths. | Privilege escalation, container breakouts, cross-project access | Post-breach simulations in multi-project setups. |
| **Automated/Red Team Simulations** | Uses scripts and tools for repeatable tests, often in CI/CD pipelines. | Continuous scanning, adversarial emulation | Ongoing security in DevSecOps environments. |
| **Service-Specific Focus** | Targets individual GCP services for in-depth risks. | Compute Engine, Kubernetes Engine, BigQuery | Hybrid or specialized cloud architectures. |

### Tools and Techniques

High-level tools for GCP pentesting include GCP-native options like Security Command Center for audits, alongside third-party ones for simulation. Common categories:
- **Auditing Tools**: ScoutSuite, Prowler for multi-cloud config checks; gcloud CLI for enumeration.
- **Exploitation Frameworks**: Custom scripts or tools like GCP IAM Auditor for role analysis.
- **Scanning Tools**: Cloud Security Scanner for web apps; third-party like Nessus adapted for cloud.

Techniques prioritize areas like IAM abuse, metadata service exploitation (similar to AWS IMDS), or API key leaks, but emphasize non-destructive methods.

### Best Practices and Considerations

- **Compliance and Ethics**: Adhere to Google's supplier guidelines for manual and authenticated testing; notify for high-impact simulations.
- **Mitigations**: Enable encryption with Cloud KMS, monitor with Cloud Logging, and use VPC Service Controls for isolation.
- **Evolution**: As of 2026, incorporate AI-driven threat modeling and zero-trust principles, with regular audits to address emerging risks like supply chain attacks.

For specific focus areas like IAM or Kubernetes, provide more details!

### Expanded Insights on GCP Penetration Testing: Focus on Tools and Credential Extraction

Building on the overview of GCP penetration testing methodologies, here's a deeper dive into tools commonly used in ethical assessments and high-level approaches for identifying and extracting credentials. As with any pentesting, these are for authorized scenarios only—ensure compliance with Google's guidelines, which allow certain simulations without notification for services like Compute Engine. The emphasis remains on demonstrating risks through non-destructive methods, aligning with frameworks like PTES or OWASP for cloud.

#### Deeper Dive into Methodologies
GCP pentesting methodologies often extend beyond basic phases to incorporate cloud-specific elements, such as API-driven attacks or multi-project lateral movement. Key expansions include:

- **Reconnaissance Enhancements**: Use automated scripts to enumerate GCP resources via APIs, focusing on exposed endpoints or DNS records.
- **Vulnerability Chaining**: Combine minor issues (e.g., a public bucket with an over-privileged IAM role) into impactful attack paths.
- **Exploitation Simulation**: Test real-world scenarios like identity compromise or data exfiltration, often using custom payloads.
- **Post-Exploitation Focus**: Assess persistence mechanisms, such as abusing service accounts for long-term access.

These methodologies prioritize manual verification over purely automated scans to uncover nuanced risks.

#### Tools for GCP Penetration Testing
Tools range from GCP-native utilities to specialized frameworks. Here's a categorized list based on common usage in 2026 assessments:

- **Auditing and Configuration Scanning**:
  - ScoutSuite: Multi-cloud tool that audits GCP for misconfigurations, including IAM bindings and open storage.
  - Prowler: Open-source for compliance checks across GCP services like firewall rules and encryption.
  - Security Command Center (GCP-native): For built-in vulnerability scanning and asset inventory.

- **Exploitation and Enumeration Frameworks**:
  - GCpwn: GCP-specific open-source toolkit for simulating attacks, including IAM testing and privilege escalation.
  - GCPBucketBrute: Python-based for brute-forcing and testing access to Cloud Storage buckets.
  - gcloud CLI: Official command-line for querying resources, often scripted for recon.

- **General Pentesting Suites**:
  - Metasploit: Modules adapted for cloud, useful for post-exploitation in hybrid setups.
  - Nessus or Qualys: Vulnerability scanners with GCP plugins for network and API testing.
  - Burp Suite: For API and web app testing within GCP environments.

These tools are often integrated into CI/CD pipelines for automated red teaming.

#### High-Level Methodologies for Extracting Credentials
Credential extraction in GCP often targets service accounts, API keys, or tokens, exploiting misconfigurations in a controlled manner. Common vectors include:

1. **Instance Metadata Service**: Similar to AWS, query the metadata endpoint on Compute Engine instances for temporary service account tokens if not restricted.

2. **Storage Artifact Scanning**: Enumerate Cloud Storage buckets for leaked keys or configs; public or weakly permissioned buckets might contain service account JSON files.

3. **IAM Role and Privilege Analysis**: Overly broad IAM policies on service accounts can allow escalation to access secrets in Cloud Secret Manager or KMS.

4. **Application and Code Inspection**: Check environment variables, mounted volumes, or code repositories on instances for hardcoded credentials.

5. **Log and Debug Outputs**: Services like Cloud Logging might inadvertently capture keys if not redacted.

6. **API Key Leaks**: Scan for exposed APIs or repositories (e.g., via OSINT) containing API keys.

7. **Container and Kubernetes Misconfigs**: In GKE, breakout techniques or env var inspections can reveal credentials if isolation is weak.

To defend: Use VPC Service Controls, enable metadata concealment, rotate keys, and monitor with Forseti or similar.

If you have a specific tool or vector in mind, or need examples from a recent case study, let me know!