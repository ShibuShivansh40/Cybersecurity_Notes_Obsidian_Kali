# IAM Enumeration with AWS CLI
In this lab we need to enumerate all the possible information that can be gathered.

At first we will configure the user account to CLI using the command : `aws configure --profile <username>`

User Info Gathering : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws sts get-caller-identity --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
    "Account": "014498641650",
    "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel"
}
```

To get User Creation Date :
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-user --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "User": {
        "Path": "/",
        "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
        "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
        "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
        "CreateDate": "2025-12-17T09:35:05+00:00",
        "Tags": [
            {
                "Key": "cybr-lab",
                "Value": "auto-deployed"
            }
        ]
    }
}
```

To get information of all the users linked to that account : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-users --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "Users": [
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Chris",
            "UserId": "AIDAQGYBPW3ZNFRBOE6G7",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Chris",
            "CreateDate": "2025-12-17T09:35:07+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mary",
            "UserId": "AIDAQGYBPW3ZEZSS7HKW6",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mary",
            "CreateDate": "2025-12-17T09:35:07+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "UserId": "AIDAQGYBPW3ZPPWDR4CSQ",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To get information regarding the Access Keys : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-access-keys --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "AccessKeyMetadata": [
        {
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "AccessKeyId": "AKIAQGYBPW3ZGI5VTUFA",
            "Status": "Active",
            "CreateDate": "2025-12-17T09:35:41+00:00"
        }
    ]
}
```

To get policies mapped in by User : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-user-policies --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "PolicyNames": [
        "AllowEnumerateRoles"
    ]
}
```

To know about the allowed Actions, Resources and Effects : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-user-policy --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --policy-name AllowEnumerateRoles --profile introduction-to-aws-iam-enumeration-1765964100680-Joel
{
    "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
    "PolicyName": "AllowEnumerateRoles",
    "PolicyDocument": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Action": [
                    "iam:GetRole",
                    "iam:GetRolePolicy",
                    "iam:ListRoles",
                    "iam:ListRolePolicies"
                ],
                "Resource": "*",
                "Effect": "Allow"
            }
        ]
    }
}
```

To know about the groups in which the profile is enrolled in : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$  aws iam list-groups --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "Groups": [
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Infrastructure",
            "GroupId": "AGPAQGYBPW3ZHIBR3EZYV",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Infrastructure",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To know about the groups in which a particular user is present is : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-groups-for-user --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --profile introduction-to-aws-iam-enumeration-1765964100680-Joel
{
    "Groups": [
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To know about the users present in that group : 
```
┌──(shibushivansh㉿shibu)-[~]
	└─$ aws iam get-group --group-name introduction-to-aws-iam-enumeration-1765964100680-Developers --profile introduction-to-aws-iam-enumeration-1765964100680-Joel                                 
{
    "Users": [
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "UserId": "AIDAQGYBPW3ZPPWDR4CSQ",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ],
    "Group": {
        "Path": "/",
        "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
        "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
        "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
        "CreateDate": "2025-12-17T09:35:05+00:00"
    }
}
```

To know the policies in which users of the group are bind into : 
```

```

To know about the Actions, Effects and Resources of the Group Policies : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-group-policy --group-name introduction-to-aws-iam-enumeration-1765964100680-Developers --policy-name introduction-to-aws-iam-enumeration-1765964100680-devs-policy --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
    "PolicyName": "introduction-to-aws-iam-enumeration-1765964100680-devs-policy",
    "PolicyDocument": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Action": [
                    "iam:ListAccessKeys"
                ],
                "Resource": [
                    "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
                    "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike"
                ],
                "Effect": "Allow"
            },
            {
                "Action": [
                    "iam:ListGroupPolicies",
                    "iam:ListAttachedPolicies",
                    "iam:ListPolicyVersions",
                    "iam:ListUserPolicies",
                    "iam:ListAttachedUserPolicies",
                    "iam:ListUsers",
                    "iam:ListGroups",
                    "iam:ListGroupsForUser",
                    "iam:GetPolicy",
                    "iam:GetPolicyVersion",
                    "iam:GetUser",
                    "iam:GetUserPolicy",
                    "iam:GetGroupPolicy",
                    "iam:GetGroup",
                    "iam:ListAttachedGroupPolicies"
                ],
                "Resource": "*",
                "Effect": "Allow"
            }
        ]
    }
}
```

To know a detailed information about roles under a profiles :
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-roles --profile cybr
{
    "Roles": [
        {
            "Path": "/aws-reserved/sso.amazonaws.com/",
            "RoleName": "AWSReservedSSO_LabAdministrationAccess_4ee15672583b2580",
            "RoleId": "AROAQGYBPW3ZOVWQBKWTD",
            "Arn": "arn:aws:iam::014498641650:role/aws-reserved/sso.amazonaws.com/AWSReservedSSO_LabAdministrationAccess_4ee15672583b2580",
            "CreateDate": "2024-07-31T17:57:39+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Federated": "arn:aws:iam::014498641650:saml-provider/AWSSSO_fd42ef2239f1ded4_DO_NOT_DELETE"
                        },
                        "Action": [
                            "sts:AssumeRoleWithSAML",
                            "sts:TagSession"
                        ],
                        "Condition": {
                            "StringEquals": {
                                "SAML:aud": "https://signin.aws.amazon.com/saml"
                            }
                        }
                    }
                ]
            },
            "Description": "Administrator access for lab accounts",
            "MaxSessionDuration": 43200
        },
        {
            "Path": "/aws-reserved/sso.amazonaws.com/",
            "RoleName": "AWSReservedSSO_LabReadOnlyAccess_0cdc66d9e0273309",
            "RoleId": "AROAQGYBPW3ZGY7YNT3YF",
            "Arn": "arn:aws:iam::014498641650:role/aws-reserved/sso.amazonaws.com/AWSReservedSSO_LabReadOnlyAccess_0cdc66d9e0273309",
            "CreateDate": "2024-07-31T17:57:39+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Federated": "arn:aws:iam::014498641650:saml-provider/AWSSSO_fd42ef2239f1ded4_DO_NOT_DELETE"
                        },
                        "Action": [
                            "sts:AssumeRoleWithSAML",
                            "sts:TagSession"
                        ],
                        "Condition": {
                            "StringEquals": {
                                "SAML:aud": "https://signin.aws.amazon.com/saml"
                            }
                        }
                    }
                ]
            },
            "Description": "Read only access for lab accounts",
            "MaxSessionDuration": 43200
        },
        {
            "Path": "/aws-service-role/guardduty.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAmazonGuardDuty",
            "RoleId": "AROAQGYBPW3ZASXARC5GV",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty",
            "CreateDate": "2025-01-20T17:44:40+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "guardduty.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "A service-linked role required for Amazon GuardDuty to access your resources. ",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/malware-protection.guardduty.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAmazonGuardDutyMalwareProtection",
            "RoleId": "AROAQGYBPW3ZPTLIYOSJ6",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/malware-protection.guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDutyMalwareProtection",
            "CreateDate": "2025-01-20T17:44:40+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "malware-protection.guardduty.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "A service-linked role required for Amazon GuardDuty Malware Scan to access your resources. ",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/notifications.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAwsUserNotifications",
            "RoleId": "AROAQGYBPW3ZDT66PCCH5",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/notifications.amazonaws.com/AWSServiceRoleForAwsUserNotifications",
            "CreateDate": "2025-11-07T18:54:01+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "notifications.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/cloudtrail.amazonaws.com/",
            "RoleName": "AWSServiceRoleForCloudTrail",
            "RoleId": "AROAQGYBPW3ZN43UT6OOJ",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/cloudtrail.amazonaws.com/AWSServiceRoleForCloudTrail",
            "CreateDate": "2024-07-31T17:18:33+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "cloudtrail.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/elasticloadbalancing.amazonaws.com/",
            "RoleName": "AWSServiceRoleForElasticLoadBalancing",
            "RoleId": "AROAQGYBPW3ZNB5KZWB5N",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing",
            "CreateDate": "2025-01-26T05:28:52+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "elasticloadbalancing.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Allows ELB to call AWS services on your behalf.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/fms.amazonaws.com/",
            "RoleName": "AWSServiceRoleForFMS",
            "RoleId": "AROAQGYBPW3ZPEVJ4TI46",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/fms.amazonaws.com/AWSServiceRoleForFMS",
            "CreateDate": "2025-01-16T20:42:17+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "fms.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/observabilityadmin.amazonaws.com/",
            "RoleName": "AWSServiceRoleForObservabilityAdmin",
            "RoleId": "AROAQGYBPW3ZKWSWYMHE2",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/observabilityadmin.amazonaws.com/AWSServiceRoleForObservabilityAdmin",
            "CreateDate": "2025-12-15T17:14:16+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "observabilityadmin.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service Linked Role for Cloudwatch Observability Admin",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/organizations.amazonaws.com/",
            "RoleName": "AWSServiceRoleForOrganizations",
            "RoleId": "AROAQGYBPW3ZFN5DKYZNC",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/organizations.amazonaws.com/AWSServiceRoleForOrganizations",
            "CreateDate": "2024-07-31T17:15:31+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "organizations.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service-linked role used by AWS Organizations to enable integration of other AWS services with Organizations.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/rds.amazonaws.com/",
            "RoleName": "AWSServiceRoleForRDS",
            "RoleId": "AROAQGYBPW3ZCUZX4XDQX",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/rds.amazonaws.com/AWSServiceRoleForRDS",
            "CreateDate": "2025-10-28T14:55:08+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "rds.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Allows Amazon RDS to manage AWS resources on your behalf",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/resource-explorer-2.amazonaws.com/",
            "RoleName": "AWSServiceRoleForResourceExplorer",
            "RoleId": "AROAQGYBPW3ZC3HDROOXE",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer",
            "CreateDate": "2025-10-28T18:37:05+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "resource-explorer-2.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/sso.amazonaws.com/",
            "RoleName": "AWSServiceRoleForSSO",
            "RoleId": "AROAQGYBPW3ZNQK2M6CL2",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/sso.amazonaws.com/AWSServiceRoleForSSO",
            "CreateDate": "2024-07-31T17:15:41+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "sso.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service-linked role used by AWS SSO to manage AWS resources, including IAM roles, policies and SAML IdP on your behalf.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/support.amazonaws.com/",
            "RoleName": "AWSServiceRoleForSupport",
            "RoleId": "AROAQGYBPW3ZMW4Y56BLL",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport",
            "CreateDate": "2024-07-31T17:15:30+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "support.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Enables resource access for AWS to provide billing, administrative and support services",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/trustedadvisor.amazonaws.com/",
            "RoleName": "AWSServiceRoleForTrustedAdvisor",
            "RoleId": "AROAQGYBPW3ZP6ZKX2QGD",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor",
            "CreateDate": "2024-07-31T17:15:30+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "trustedadvisor.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Access for the AWS Trusted Advisor Service to help reduce cost, increase performance, and improve security of your AWS environment.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "lab",
            "RoleId": "AROAQGYBPW3ZGDLGSBLGV",
            "Arn": "arn:aws:iam::014498641650:role/lab",
            "CreateDate": "2024-07-31T18:07:31+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": [
                                "arn:aws:iam::014498641272:root",
                                "arn:aws:iam::174005215664:root"
                            ]
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "codebuild.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "lambda.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "cloudformation.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "OrganizationAccountAccessRole",
            "RoleId": "AROAQGYBPW3ZL4KAPN75A",
            "Arn": "arn:aws:iam::014498641650:role/OrganizationAccountAccessRole",
            "CreateDate": "2024-07-31T17:15:30+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::174005215664:root"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "SupportRole",
            "RoleId": "AROAQGYBPW3ZLMNVH3M52",
            "Arn": "arn:aws:iam::014498641650:role/SupportRole",
            "CreateDate": "2025-12-17T11:13:39+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::014498641650:root"
                        },
                        "Action": "sts:AssumeRole",
                        "Condition": {
                            "ArnEquals": {
                                "aws:PrincipalArn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mary"
                            }
                        }
                    }
                ]
            },
            "Description": "Assumable role for internal support",
            "MaxSessionDuration": 3600
        }
    ]
}
        },
        {
            "Path": "/",
            "RoleName": "OrganizationAccountAccessRole",
            "RoleId": "AROAQGYBPW3ZL4KAPN75A",
            "Arn": "arn:aws:iam::014498641650:role/OrganizationAccountAccessRole",
            "CreateDate": "2024-07-31T17:15:30+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::174005215664:root"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "SupportRole",
            "RoleId": "AROAQGYBPW3ZLMNVH3M52",
            "Arn": "arn:aws:iam::014498641650:role/SupportRole",
            "CreateDate": "2025-12-17T11:13:39+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::014498641650:root"
                        },
                        "Action": "sts:AssumeRole",
                        "Condition": {
                            "ArnEquals": {
                                "aws:PrincipalArn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mary"
                            }
                        }
                    }
                ]
            },
            "Description": "Assumable role for internal support",
            "MaxSessionDuration": 3600
        }
    ]
}
(END) 
```

To know about a particular Role : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-roles --query "Roles[?RoleName=='SupportRole']" --profile cybr
[
    {
        "Path": "/",
        "RoleName": "SupportRole",
        "RoleId": "AROAQGYBPW3ZLMNVH3M52",
        "Arn": "arn:aws:iam::014498641650:role/SupportRole",
        "CreateDate": "2025-12-17T11:13:39+00:00",
        "AssumeRolePolicyDocument": {
            "Version": "2012-10-17",
            "Statement": [
                {
                    "Effect": "Allow",
                    "Principal": {
                        "AWS": "arn:aws:iam::014498641650:root"
                    },
                    "Action": "sts:AssumeRole",
                    "Condition": {
                        "ArnEquals": {
                            "aws:PrincipalArn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mary"
                        }
                    }
                }
            ]
        },
        "Description": "Assumable role for internal support",
        "MaxSessionDuration": 3600
    }
]
```

To know about the policies of a particular role : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-role-policies --role-name SupportRole --profile cybr
{
    "PolicyNames": [
        "AllowS3FullAccessForRole"
    ]
}
```

To know about the Actions, Effects and Resources accessible under that policy in that role : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-role-policy --role-name SupportRole --policy-name AllowS3FullAccessForRole --profile cybr
{
    "RoleName": "SupportRole",
    "PolicyName": "AllowS3FullAccessForRole",
    "PolicyDocument": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Action": [
                    "s3:*"
                ],
                "Resource": "*",
                "Effect": "Allow",
                "Sid": "AllowS3FullAccess"
            }
        ]
    }
}
```

# Enumerating Users, Roles, Policies & Groups using Pacu
To set keys use the command : `set_keys`
To import the keys from Amazon CLI, use the command : `import_keys <profile_name>`
To run a particular module, `
```
┌──(shibushivansh㉿shibu)-[~]
└─$ pacu

 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⣶⣿⣿⣿⣿⣿⣿⣶⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⣿⡿⠛⠉⠁⠀⠀⠈⠙⠻⣿⣿⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠛⠛⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⣿⣷⣀⣀⣀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀
 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣤⣤⣤⣤⣤⣤⣤⣤⣀⣀⠀⠀⠀⠀⠀⠀⢻⣿⣿⣿⡿⣿⣿⣷⣦⠀⠀⠀⠀⠀⠀⠀
 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣀⣈⣉⣙⣛⣿⣿⣿⣿⣿⣿⣿⣿⡟⠛⠿⢿⣿⣷⣦⣄⠀⠀⠈⠛⠋⠀⠀⠀⠈⠻⣿⣷⠀⠀⠀⠀⠀⠀
 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣈⣉⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣀⣀⣀⣤⣿⣿⣿⣷⣦⡀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣆⠀⠀⠀⠀⠀
 ⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣬⣭⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠛⢛⣉⣉⣡⣄⠀⠀⠀⠀⠀⠀⠀⠀⠻⢿⣿⣿⣶⣄⠀⠀
 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋⣁⣤⣶⡿⣿⣿⠉⠻⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢻⣿⣧⡀
 ⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋⣠⣶⣿⡟⠻⣿⠃⠈⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⣿⣧
 ⢀⣀⣤⣴⣶⣶⣶⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠁⢠⣾⣿⠉⠻⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿
 ⠉⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠁⠀⠀⠀⠀⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⡟
 ⠀⠀⠀⠀⠉⣻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⡟⠁
 ⠀⠀⠀⢀⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⣄⡀⠀⠀⠀⠀⠀⣴⣆⢀⣴⣆⠀⣼⣆⠀⠀⣶⣶⣶⣶⣶⣶⣶⣶⣾⣿⣿⠿⠋⠀⠀
 ⠀⠀⠀⣼⣿⣿⣿⠿⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠓⠒⠒⠚⠛⠛⠛⠛⠛⠛⠛⠛⠀⠀⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠀⠀⠀⠀⠀
 ⠀⠀⠀⣿⣿⠟⠁⠀⢸⣿⣿⣿⣿⣿⣿⣿⣶⡀⠀⢠⣾⣿⣿⣿⣿⣿⣿⣷⡄⠀⢀⣾⣿⣿⣿⣿⣿⣿⣷⣆⠀⢰⣿⣿⣿⠀⠀⠀⣿⣿⣿
 ⠀⠀⠀⠘⠁⠀⠀⠀⢸⣿⣿⡿⠛⠛⢻⣿⣿⡇⠀⢸⣿⣿⡿⠛⠛⢿⣿⣿⡇⠀⢸⣿⣿⡿⠛⠛⢻⣿⣿⣿⠀⢸⣿⣿⣿⠀⠀⠀⣿⣿⣿
 ⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⡇⠀⠀⢸⣿⣿⡇⠀⢸⣿⣿⡇⠀⠀⢸⣿⣿⡇⠀⢸⣿⣿⡇⠀⠀⠸⠿⠿⠟⠀⢸⣿⣿⣿⠀⠀⠀⣿⣿⣿
 ⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⡇⠀⠀⢸⣿⣿⡇⠀⢸⣿⣿⡇⠀⠀⢸⣿⣿⡇⠀⢸⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣿⠀⠀⠀⣿⣿⣿
 ⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣧⣤⣤⣼⣿⣿⡇⠀⢸⣿⣿⣧⣤⣤⣼⣿⣿⡇⠀⢸⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣿⠀⠀⠀⣿⣿⣿
 ⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣿⣿⣿⣿⣿⡿⠃⠀⢸⣿⣿⣿⣿⣿⣿⣿⣿⡇⠀⢸⣿⣿⡇⠀⠀⢀⣀⣀⣀⠀⢸⣿⣿⣿⠀⠀⠀⣿⣿⣿
 ⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⡏⠉⠉⠉⠉⠀⠀⠀⢸⣿⣿⡏⠉⠉⢹⣿⣿⡇⠀⢸⣿⣿⣇⣀⣀⣸⣿⣿⣿⠀⢸⣿⣿⣿⣀⣀⣀⣿⣿⣿
 ⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⡇⠀⠀⢸⣿⣿⡇⠀⠸⣿⣿⣿⣿⣿⣿⣿⣿⡿⠀⠀⢿⣿⣿⣿⣿⣿⣿⣿⡟
 ⠀⠀⠀⠀⠀⠀⠀⠀⠘⠛⠛⠃⠀⠀⠀⠀⠀⠀⠀⠘⠛⠛⠃⠀⠀⠘⠛⠛⠃⠀⠀⠉⠛⠛⠛⠛⠛⠛⠋⠀⠀⠀⠀⠙⠛⠛⠛⠛⠛⠉⠀

Version: unknown
Found existing sessions:
  [0] New session
  [1] cloudgoat
  [2] cybr
Choose an option: 2

    Pacu - https://github.com/RhinoSecurityLabs/pacu
    Written and researched by Spencer Gietzen of Rhino Security Labs - https://rhinosecuritylabs.com/

    This was built as a modular, open source tool to assist in penetration testing an AWS environment.
    For usage and developer documentation, please visit the GitHub page.

    Modules that have pre-requisites will have those listed in that modules help info, but if it is
    executed before its pre-reqs have been filled, it will prompt you to run that module then continue
    once that is finished, so you have the necessary data for the module you want to run.

    Pacu command info:
        list/ls                             List all modules
        load_commands_file <file>           Load an existing file with list of commands to execute
        search [cat[egory]] <search term>   Search the list of available modules by name or category
        help                                Display this page of information
        clear                               Clear the terminal
        help <module name>                  Display information about a module
        whoami                              Display information regarding to the active access keys
        data                                Display all data that is stored in this session. Only fields
                                              with values will be displayed
        data <service> [<sub-service>]      Display all data for a specified service in this session
        jq <query> <service> [<sub-service>] Run a jq statement on the specified service's data
        services                            Display a list of services that have collected data in the
                                              current session to use with the "data" command
        regions                             Display a list of all valid AWS regions
        update_regions                      Run a script to update the regions database to the newest
                                              version
        set_regions <region> [<region>...]  Set the default regions for this session. These space-separated
                                              regions will be used for modules where regions are required,
                                              but not supplied by the user. The default set of regions is
                                              every supported region for the service. Supply "all" to this
                                              command to reset the region set to the default of all
                                              supported regions
        set_ua_suffix [<suffix>]            Set the user agent suffix for this session. The suffix will be
                                              appended to the user agent for all API calls. If no suffix is
                                              supplied a UUID-based suffix will be generated.
        unset_ua_suffix                     Remove the user agent suffix for this session.
        run/exec/use <module name>          Execute a module
        set_keys                            Add a set of AWS keys to the session and set them as the
                                              default
        swap_keys                           Change the currently active AWS key to another key that has
                                              previously been set for this session
        import_keys <profile name>|--all    Import AWS keys from the AWS CLI credentials file (located
                                              at ~/.aws/credentials) to the current sessions database.
                                              Enter the name of a profile you would like to import or
                                              supply --all to import all the credentials in the file.
        delete_keys                         Delete a set of AWS keys in the current session from the Pacu database
        assume_role <role arn>              Call AssumeRole on the specified role from the current
           [<serial arn>] [<token code>]      credentials, add the resulting temporary keys to the Pacu
                                              key database and start using these new credentials.
                                              Optionally you can provide serial number arn and token code
                                              in case MFA is required to assume the role
        export_keys                         Export the active credentials to a profile in the AWS CLI
                                              credentials file (~/.aws/credentials)
        sessions/list_sessions              List all sessions in the Pacu database
        swap_session <session name>         Change the active Pacu session to another one in the database
        delete_session                      Delete a Pacu session from the database. Note that the output
                                              folder for that session will not be deleted
        history                             List the previously typed commands

        exit/quit                           Exit Pacu

    Other command info:
        aws <command>                       Run an AWS CLI command directly. Note: If Pacu detects "aws"
                                              as the first word of the command, the whole command will
                                              instead be run in a shell so that you can use the AWS CLI
                                              from within Pacu. Due to the command running in a shell,
                                              this enables you to pipe output where needed. An example
                                              would be to run an AWS CLI command and pipe it into "jq"
                                              to parse the data returned. Warning: The AWS CLI's
                                              authentication is not related to Pacu. Be careful to
                                              ensure that you are using the keys you want when using
                                              the AWS CLI. It is suggested to use AWS CLI profiles
                                              to solve this problem
        console/open_console                Generate a URL that will log the current user/role in to
                                              the AWS web console
        debug                               Display the contents of the error log file
    
Pacu (cybr:No Keys Set) > set_keys
Setting AWS Keys...
Press enter to keep the value currently stored.
Enter the letter C to clear the value, rather than set it.
If you enter an existing key_alias, that key's fields will be updated instead of added.
Key alias must be at least 2 characters

Key alias [None]: cybr_enum
Access key ID [None]: AKIAQGYBPW3ZDYZ7RO56
Secret access key [None]: 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
Session token (Optional - for temp AWS keys only) [None]: 

Keys saved to database.

Pacu (cybr:cybr_enum) > help iam__enum_users_roles_policies_groups 

iam__enum_users_roles_policies_groups written by Spencer Gietzen of Rhino Security Labs.

usage: pacu [--users] [--roles] [--policies] [--groups]

This module requests the info for all users, roles, customer-managed policies, and groups in the account. If no arguments are supplied, it will enumerate all four, if any are supplied, it will enumerate those only.

options:
  --users     Enumerate info for users in the account
  --roles     Enumerate info for roles in the account
  --policies  Enumerate info for policies in the account
  --groups    Enumerate info for groups in the account

Pacu (cybr:cybr_enum) > run iam__enum_users_roles_policies_groups 
  Running module iam__enum_users_roles_policies_groups...
[iam__enum_users_roles_policies_groups] Found 4 users
[iam__enum_users_roles_policies_groups] Found 18 roles
[iam__enum_users_roles_policies_groups] No Policies Found
[iam__enum_users_roles_policies_groups]   FAILURE: MISSING NEEDED PERMISSIONS
[iam__enum_users_roles_policies_groups] Found 2 groups
[iam__enum_users_roles_policies_groups] iam__enum_users_roles_policies_groups completed.

[iam__enum_users_roles_policies_groups] MODULE SUMMARY:

  4 Users Enumerated
  18 Roles Enumerated
  0 Policies Enumerated
  2 Groups Enumerated
  IAM resources saved in Pacu database.

Pacu (cybr:cybr_enum) > data

Session data:
aws_keys: [
    <AWSKey: cybr_enum>
]
id: 2
created: "2025-12-17 11:29:16.559286"
is_active: true
name: "cybr"
boto_user_agent: "aws-cli/1.17.1 Python/3.6.9 Linux/4.4.0-18362-Microsoft botocore/1.14.2"
key_alias: "cybr_enum"
access_key_id: "AKIAQGYBPW3ZDYZ7RO56"
secret_access_key: "******" (Censored)
session_regions: [
    "all"
]
IAM: {
    "Users": [
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765969997529-Chris",
            "UserId": "AIDAQGYBPW3ZKBLNLCMVS",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Chris",
            "CreateDate": "Wed, 17 Dec 2025 11:13:23"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765969997529-Joel",
            "UserId": "AIDAQGYBPW3ZFUU26IVIY",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Joel",
            "CreateDate": "Wed, 17 Dec 2025 11:13:22"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765969997529-Mary",
            "UserId": "AIDAQGYBPW3ZFBJRMTMCR",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mary",
            "CreateDate": "Wed, 17 Dec 2025 11:13:23"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765969997529-Mike",
            "UserId": "AIDAQGYBPW3ZPMOCV4JJI",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mike",
            "CreateDate": "Wed, 17 Dec 2025 11:13:21"
        }
    ],
    "Roles": [
        {
            "Path": "/aws-reserved/sso.amazonaws.com/",
            "RoleName": "AWSReservedSSO_LabAdministrationAccess_4ee15672583b2580",
            "RoleId": "AROAQGYBPW3ZOVWQBKWTD",
            "Arn": "arn:aws:iam::014498641650:role/aws-reserved/sso.amazonaws.com/AWSReservedSSO_LabAdministrationAccess_4ee15672583b2580",
            "CreateDate": "Wed, 31 Jul 2024 17:57:39",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Federated": "arn:aws:iam::014498641650:saml-provider/AWSSSO_fd42ef2239f1ded4_DO_NOT_DELETE"
                        },
                        "Action": [
                            "sts:AssumeRoleWithSAML",
                            "sts:TagSession"
                        ],
                        "Condition": {
                            "StringEquals": {
                                "SAML:aud": "https://signin.aws.amazon.com/saml"
                            }
                        }
                    }
                ]
            },
            "Description": "Administrator access for lab accounts",
            "MaxSessionDuration": 43200
        },
        {
            "Path": "/aws-reserved/sso.amazonaws.com/",
            "RoleName": "AWSReservedSSO_LabReadOnlyAccess_0cdc66d9e0273309",
            "RoleId": "AROAQGYBPW3ZGY7YNT3YF",
            "Arn": "arn:aws:iam::014498641650:role/aws-reserved/sso.amazonaws.com/AWSReservedSSO_LabReadOnlyAccess_0cdc66d9e0273309",
            "CreateDate": "Wed, 31 Jul 2024 17:57:39",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Federated": "arn:aws:iam::014498641650:saml-provider/AWSSSO_fd42ef2239f1ded4_DO_NOT_DELETE"
                        },
                        "Action": [
                            "sts:AssumeRoleWithSAML",
                            "sts:TagSession"
                        ],
                        "Condition": {
                            "StringEquals": {
                                "SAML:aud": "https://signin.aws.amazon.com/saml"
                            }
                        }
                    }
                ]
            },
            "Description": "Read only access for lab accounts",
            "MaxSessionDuration": 43200
        },
        {
            "Path": "/aws-service-role/guardduty.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAmazonGuardDuty",
            "RoleId": "AROAQGYBPW3ZASXARC5GV",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty",
            "CreateDate": "Mon, 20 Jan 2025 17:44:40",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "guardduty.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "A service-linked role required for Amazon GuardDuty to access your resources. ",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/malware-protection.guardduty.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAmazonGuardDutyMalwareProtection",
            "RoleId": "AROAQGYBPW3ZPTLIYOSJ6",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/malware-protection.guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDutyMalwareProtection",
            "CreateDate": "Mon, 20 Jan 2025 17:44:40",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "malware-protection.guardduty.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "A service-linked role required for Amazon GuardDuty Malware Scan to access your resources. ",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/notifications.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAwsUserNotifications",
            "RoleId": "AROAQGYBPW3ZDT66PCCH5",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/notifications.amazonaws.com/AWSServiceRoleForAwsUserNotifications",
            "CreateDate": "Fri, 07 Nov 2025 18:54:01",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "notifications.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/cloudtrail.amazonaws.com/",
            "RoleName": "AWSServiceRoleForCloudTrail",
            "RoleId": "AROAQGYBPW3ZN43UT6OOJ",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/cloudtrail.amazonaws.com/AWSServiceRoleForCloudTrail",
            "CreateDate": "Wed, 31 Jul 2024 17:18:33",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "cloudtrail.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/elasticloadbalancing.amazonaws.com/",
            "RoleName": "AWSServiceRoleForElasticLoadBalancing",
            "RoleId": "AROAQGYBPW3ZNB5KZWB5N",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing",
            "CreateDate": "Sun, 26 Jan 2025 05:28:52",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "elasticloadbalancing.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Allows ELB to call AWS services on your behalf.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/fms.amazonaws.com/",
            "RoleName": "AWSServiceRoleForFMS",
            "RoleId": "AROAQGYBPW3ZPEVJ4TI46",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/fms.amazonaws.com/AWSServiceRoleForFMS",
            "CreateDate": "Thu, 16 Jan 2025 20:42:17",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "fms.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/observabilityadmin.amazonaws.com/",
            "RoleName": "AWSServiceRoleForObservabilityAdmin",
            "RoleId": "AROAQGYBPW3ZKWSWYMHE2",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/observabilityadmin.amazonaws.com/AWSServiceRoleForObservabilityAdmin",
            "CreateDate": "Mon, 15 Dec 2025 17:14:16",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "observabilityadmin.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service Linked Role for Cloudwatch Observability Admin",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/organizations.amazonaws.com/",
            "RoleName": "AWSServiceRoleForOrganizations",
            "RoleId": "AROAQGYBPW3ZFN5DKYZNC",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/organizations.amazonaws.com/AWSServiceRoleForOrganizations",
            "CreateDate": "Wed, 31 Jul 2024 17:15:31",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "organizations.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service-linked role used by AWS Organizations to enable integration of other AWS services with Organizations.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/rds.amazonaws.com/",
            "RoleName": "AWSServiceRoleForRDS",
            "RoleId": "AROAQGYBPW3ZCUZX4XDQX",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/rds.amazonaws.com/AWSServiceRoleForRDS",
            "CreateDate": "Tue, 28 Oct 2025 14:55:08",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "rds.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Allows Amazon RDS to manage AWS resources on your behalf",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/resource-explorer-2.amazonaws.com/",
            "RoleName": "AWSServiceRoleForResourceExplorer",
            "RoleId": "AROAQGYBPW3ZC3HDROOXE",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer",
            "CreateDate": "Tue, 28 Oct 2025 18:37:05",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "resource-explorer-2.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/sso.amazonaws.com/",
            "RoleName": "AWSServiceRoleForSSO",
            "RoleId": "AROAQGYBPW3ZNQK2M6CL2",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/sso.amazonaws.com/AWSServiceRoleForSSO",
            "CreateDate": "Wed, 31 Jul 2024 17:15:41",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "sso.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service-linked role used by AWS SSO to manage AWS resources, including IAM roles, policies and SAML IdP on your behalf.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/support.amazonaws.com/",
            "RoleName": "AWSServiceRoleForSupport",
            "RoleId": "AROAQGYBPW3ZMW4Y56BLL",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport",
            "CreateDate": "Wed, 31 Jul 2024 17:15:30",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "support.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Enables resource access for AWS to provide billing, administrative and support services",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/trustedadvisor.amazonaws.com/",
            "RoleName": "AWSServiceRoleForTrustedAdvisor",
            "RoleId": "AROAQGYBPW3ZP6ZKX2QGD",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor",
            "CreateDate": "Wed, 31 Jul 2024 17:15:30",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "trustedadvisor.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Access for the AWS Trusted Advisor Service to help reduce cost, increase performance, and improve security of your AWS environment.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "lab",
            "RoleId": "AROAQGYBPW3ZGDLGSBLGV",
            "Arn": "arn:aws:iam::014498641650:role/lab",
            "CreateDate": "Wed, 31 Jul 2024 18:07:31",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": [
                                "arn:aws:iam::174005215664:root",
                                "arn:aws:iam::014498641272:root"
                            ]
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "codebuild.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "lambda.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "cloudformation.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "OrganizationAccountAccessRole",
            "RoleId": "AROAQGYBPW3ZL4KAPN75A",
            "Arn": "arn:aws:iam::014498641650:role/OrganizationAccountAccessRole",
            "CreateDate": "Wed, 31 Jul 2024 17:15:30",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::174005215664:root"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "SupportRole",
            "RoleId": "AROAQGYBPW3ZLMNVH3M52",
            "Arn": "arn:aws:iam::014498641650:role/SupportRole",
            "CreateDate": "Wed, 17 Dec 2025 11:13:39",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::014498641650:root"
                        },
                        "Action": "sts:AssumeRole",
                        "Condition": {
                            "ArnEquals": {
                                "aws:PrincipalArn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mary"
                            }
                        }
                    }
                ]
            },
            "Description": "Assumable role for internal support",
            "MaxSessionDuration": 3600
        }
    ],
    "Groups": [
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765969997529-Developers",
            "GroupId": "AGPAQGYBPW3ZJGZRLW5MT",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765969997529-Developers",
            "CreateDate": "Wed, 17 Dec 2025 11:13:22"
        },
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765969997529-Infrastructure",
            "GroupId": "AGPAQGYBPW3ZBIYUR2IDM",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765969997529-Infrastructure",
            "CreateDate": "Wed, 17 Dec 2025 11:13:22"
        }
    ]
}
Pacu (cybr:cybr_enum) > 


```