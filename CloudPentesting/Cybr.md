# IAM Enumeration with AWS CLI
In this lab we need to enumerate all the possible information that can be gathered.

At first we will configure the user account to CLI using the command : `aws configure --profile <username>`

User Info Gathering : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws sts get-caller-identity --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
    "Account": "014498641650",
    "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel"
}
```

To get User Creation Date :
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-user --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "User": {
        "Path": "/",
        "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
        "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
        "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
        "CreateDate": "2025-12-17T09:35:05+00:00",
        "Tags": [
            {
                "Key": "cybr-lab",
                "Value": "auto-deployed"
            }
        ]
    }
}
```

To get information of all the users linked to that account : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-users --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "Users": [
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Chris",
            "UserId": "AIDAQGYBPW3ZNFRBOE6G7",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Chris",
            "CreateDate": "2025-12-17T09:35:07+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mary",
            "UserId": "AIDAQGYBPW3ZEZSS7HKW6",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mary",
            "CreateDate": "2025-12-17T09:35:07+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "UserId": "AIDAQGYBPW3ZPPWDR4CSQ",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To get information regarding the Access Keys : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-access-keys --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "AccessKeyMetadata": [
        {
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "AccessKeyId": "AKIAQGYBPW3ZGI5VTUFA",
            "Status": "Active",
            "CreateDate": "2025-12-17T09:35:41+00:00"
        }
    ]
}
```

To get policies mapped in by User : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-user-policies --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "PolicyNames": [
        "AllowEnumerateRoles"
    ]
}
```

To know about the allowed Actions, Resources and Effects : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-user-policy --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --policy-name AllowEnumerateRoles --profile introduction-to-aws-iam-enumeration-1765964100680-Joel
{
    "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
    "PolicyName": "AllowEnumerateRoles",
    "PolicyDocument": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Action": [
                    "iam:GetRole",
                    "iam:GetRolePolicy",
                    "iam:ListRoles",
                    "iam:ListRolePolicies"
                ],
                "Resource": "*",
                "Effect": "Allow"
            }
        ]
    }
}
```

To know about the groups in which the profile is enrolled in : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$  aws iam list-groups --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "Groups": [
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Infrastructure",
            "GroupId": "AGPAQGYBPW3ZHIBR3EZYV",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Infrastructure",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To know about the groups in which a particular user is present is : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-groups-for-user --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --profile introduction-to-aws-iam-enumeration-1765964100680-Joel
{
    "Groups": [
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To know about the users present in that group : 
```
┌──(shibushivansh㉿shibu)-[~]
	└─$ aws iam get-group --group-name introduction-to-aws-iam-enumeration-1765964100680-Developers --profile introduction-to-aws-iam-enumeration-1765964100680-Joel                                 
{
    "Users": [
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "UserId": "AIDAQGYBPW3ZPPWDR4CSQ",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ],
    "Group": {
        "Path": "/",
        "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
        "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
        "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
        "CreateDate": "2025-12-17T09:35:05+00:00"
    }
}
```

To know the policies in which users of the group are bind into : 
```

```

To know about the Actions, Effects and Resources of the Group Policies : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-group-policy --group-name introduction-to-aws-iam-enumeration-1765964100680-Developers --policy-name introduction-to-aws-iam-enumeration-1765964100680-devs-policy --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
    "PolicyName": "introduction-to-aws-iam-enumeration-1765964100680-devs-policy",
    "PolicyDocument": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Action": [
                    "iam:ListAccessKeys"
                ],
                "Resource": [
                    "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
                    "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike"
                ],
                "Effect": "Allow"
            },
            {
                "Action": [
                    "iam:ListGroupPolicies",
                    "iam:ListAttachedPolicies",
                    "iam:ListPolicyVersions",
                    "iam:ListUserPolicies",
                    "iam:ListAttachedUserPolicies",
                    "iam:ListUsers",
                    "iam:ListGroups",
                    "iam:ListGroupsForUser",
                    "iam:GetPolicy",
                    "iam:GetPolicyVersion",
                    "iam:GetUser",
                    "iam:GetUserPolicy",
                    "iam:GetGroupPolicy",
                    "iam:GetGroup",
                    "iam:ListAttachedGroupPolicies"
                ],
                "Resource": "*",
                "Effect": "Allow"
            }
        ]
    }
}
```

To know a detailed information about roles under a profiles :
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-roles --profile cybr
{
    "Roles": [
        {
            "Path": "/aws-reserved/sso.amazonaws.com/",
            "RoleName": "AWSReservedSSO_LabAdministrationAccess_4ee15672583b2580",
            "RoleId": "AROAQGYBPW3ZOVWQBKWTD",
            "Arn": "arn:aws:iam::014498641650:role/aws-reserved/sso.amazonaws.com/AWSReservedSSO_LabAdministrationAccess_4ee15672583b2580",
            "CreateDate": "2024-07-31T17:57:39+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Federated": "arn:aws:iam::014498641650:saml-provider/AWSSSO_fd42ef2239f1ded4_DO_NOT_DELETE"
                        },
                        "Action": [
                            "sts:AssumeRoleWithSAML",
                            "sts:TagSession"
                        ],
                        "Condition": {
                            "StringEquals": {
                                "SAML:aud": "https://signin.aws.amazon.com/saml"
                            }
                        }
                    }
                ]
            },
            "Description": "Administrator access for lab accounts",
            "MaxSessionDuration": 43200
        },
        {
            "Path": "/aws-reserved/sso.amazonaws.com/",
            "RoleName": "AWSReservedSSO_LabReadOnlyAccess_0cdc66d9e0273309",
            "RoleId": "AROAQGYBPW3ZGY7YNT3YF",
            "Arn": "arn:aws:iam::014498641650:role/aws-reserved/sso.amazonaws.com/AWSReservedSSO_LabReadOnlyAccess_0cdc66d9e0273309",
            "CreateDate": "2024-07-31T17:57:39+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Federated": "arn:aws:iam::014498641650:saml-provider/AWSSSO_fd42ef2239f1ded4_DO_NOT_DELETE"
                        },
                        "Action": [
                            "sts:AssumeRoleWithSAML",
                            "sts:TagSession"
                        ],
                        "Condition": {
                            "StringEquals": {
                                "SAML:aud": "https://signin.aws.amazon.com/saml"
                            }
                        }
                    }
                ]
            },
            "Description": "Read only access for lab accounts",
            "MaxSessionDuration": 43200
        },
        {
            "Path": "/aws-service-role/guardduty.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAmazonGuardDuty",
            "RoleId": "AROAQGYBPW3ZASXARC5GV",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty",
            "CreateDate": "2025-01-20T17:44:40+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "guardduty.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "A service-linked role required for Amazon GuardDuty to access your resources. ",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/malware-protection.guardduty.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAmazonGuardDutyMalwareProtection",
            "RoleId": "AROAQGYBPW3ZPTLIYOSJ6",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/malware-protection.guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDutyMalwareProtection",
            "CreateDate": "2025-01-20T17:44:40+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "malware-protection.guardduty.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "A service-linked role required for Amazon GuardDuty Malware Scan to access your resources. ",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/notifications.amazonaws.com/",
            "RoleName": "AWSServiceRoleForAwsUserNotifications",
            "RoleId": "AROAQGYBPW3ZDT66PCCH5",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/notifications.amazonaws.com/AWSServiceRoleForAwsUserNotifications",
            "CreateDate": "2025-11-07T18:54:01+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "notifications.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/cloudtrail.amazonaws.com/",
            "RoleName": "AWSServiceRoleForCloudTrail",
            "RoleId": "AROAQGYBPW3ZN43UT6OOJ",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/cloudtrail.amazonaws.com/AWSServiceRoleForCloudTrail",
            "CreateDate": "2024-07-31T17:18:33+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "cloudtrail.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/elasticloadbalancing.amazonaws.com/",
            "RoleName": "AWSServiceRoleForElasticLoadBalancing",
            "RoleId": "AROAQGYBPW3ZNB5KZWB5N",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing",
            "CreateDate": "2025-01-26T05:28:52+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "elasticloadbalancing.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Allows ELB to call AWS services on your behalf.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/fms.amazonaws.com/",
            "RoleName": "AWSServiceRoleForFMS",
            "RoleId": "AROAQGYBPW3ZPEVJ4TI46",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/fms.amazonaws.com/AWSServiceRoleForFMS",
            "CreateDate": "2025-01-16T20:42:17+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "fms.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/observabilityadmin.amazonaws.com/",
            "RoleName": "AWSServiceRoleForObservabilityAdmin",
            "RoleId": "AROAQGYBPW3ZKWSWYMHE2",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/observabilityadmin.amazonaws.com/AWSServiceRoleForObservabilityAdmin",
            "CreateDate": "2025-12-15T17:14:16+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "observabilityadmin.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service Linked Role for Cloudwatch Observability Admin",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/organizations.amazonaws.com/",
            "RoleName": "AWSServiceRoleForOrganizations",
            "RoleId": "AROAQGYBPW3ZFN5DKYZNC",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/organizations.amazonaws.com/AWSServiceRoleForOrganizations",
            "CreateDate": "2024-07-31T17:15:31+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "organizations.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service-linked role used by AWS Organizations to enable integration of other AWS services with Organizations.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/rds.amazonaws.com/",
            "RoleName": "AWSServiceRoleForRDS",
            "RoleId": "AROAQGYBPW3ZCUZX4XDQX",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/rds.amazonaws.com/AWSServiceRoleForRDS",
            "CreateDate": "2025-10-28T14:55:08+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "rds.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Allows Amazon RDS to manage AWS resources on your behalf",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/resource-explorer-2.amazonaws.com/",
            "RoleName": "AWSServiceRoleForResourceExplorer",
            "RoleId": "AROAQGYBPW3ZC3HDROOXE",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer",
            "CreateDate": "2025-10-28T18:37:05+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "resource-explorer-2.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/sso.amazonaws.com/",
            "RoleName": "AWSServiceRoleForSSO",
            "RoleId": "AROAQGYBPW3ZNQK2M6CL2",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/sso.amazonaws.com/AWSServiceRoleForSSO",
            "CreateDate": "2024-07-31T17:15:41+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "sso.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Service-linked role used by AWS SSO to manage AWS resources, including IAM roles, policies and SAML IdP on your behalf.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/support.amazonaws.com/",
            "RoleName": "AWSServiceRoleForSupport",
            "RoleId": "AROAQGYBPW3ZMW4Y56BLL",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport",
            "CreateDate": "2024-07-31T17:15:30+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "support.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Enables resource access for AWS to provide billing, administrative and support services",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/aws-service-role/trustedadvisor.amazonaws.com/",
            "RoleName": "AWSServiceRoleForTrustedAdvisor",
            "RoleId": "AROAQGYBPW3ZP6ZKX2QGD",
            "Arn": "arn:aws:iam::014498641650:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor",
            "CreateDate": "2024-07-31T17:15:30+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "trustedadvisor.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "Access for the AWS Trusted Advisor Service to help reduce cost, increase performance, and improve security of your AWS environment.",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "lab",
            "RoleId": "AROAQGYBPW3ZGDLGSBLGV",
            "Arn": "arn:aws:iam::014498641650:role/lab",
            "CreateDate": "2024-07-31T18:07:31+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": [
                                "arn:aws:iam::014498641272:root",
                                "arn:aws:iam::174005215664:root"
                            ]
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "codebuild.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "lambda.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    },
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "Service": "cloudformation.amazonaws.com"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "Description": "",
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "OrganizationAccountAccessRole",
            "RoleId": "AROAQGYBPW3ZL4KAPN75A",
            "Arn": "arn:aws:iam::014498641650:role/OrganizationAccountAccessRole",
            "CreateDate": "2024-07-31T17:15:30+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::174005215664:root"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "SupportRole",
            "RoleId": "AROAQGYBPW3ZLMNVH3M52",
            "Arn": "arn:aws:iam::014498641650:role/SupportRole",
            "CreateDate": "2025-12-17T11:13:39+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::014498641650:root"
                        },
                        "Action": "sts:AssumeRole",
                        "Condition": {
                            "ArnEquals": {
                                "aws:PrincipalArn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mary"
                            }
                        }
                    }
                ]
            },
            "Description": "Assumable role for internal support",
            "MaxSessionDuration": 3600
        }
    ]
}
        },
        {
            "Path": "/",
            "RoleName": "OrganizationAccountAccessRole",
            "RoleId": "AROAQGYBPW3ZL4KAPN75A",
            "Arn": "arn:aws:iam::014498641650:role/OrganizationAccountAccessRole",
            "CreateDate": "2024-07-31T17:15:30+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::174005215664:root"
                        },
                        "Action": "sts:AssumeRole"
                    }
                ]
            },
            "MaxSessionDuration": 3600
        },
        {
            "Path": "/",
            "RoleName": "SupportRole",
            "RoleId": "AROAQGYBPW3ZLMNVH3M52",
            "Arn": "arn:aws:iam::014498641650:role/SupportRole",
            "CreateDate": "2025-12-17T11:13:39+00:00",
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "arn:aws:iam::014498641650:root"
                        },
                        "Action": "sts:AssumeRole",
                        "Condition": {
                            "ArnEquals": {
                                "aws:PrincipalArn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mary"
                            }
                        }
                    }
                ]
            },
            "Description": "Assumable role for internal support",
            "MaxSessionDuration": 3600
        }
    ]
}
(END) 
```

To know about a particular Role : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-roles --query "Roles[?RoleName=='SupportRole']" --profile cybr
[
    {
        "Path": "/",
        "RoleName": "SupportRole",
        "RoleId": "AROAQGYBPW3ZLMNVH3M52",
        "Arn": "arn:aws:iam::014498641650:role/SupportRole",
        "CreateDate": "2025-12-17T11:13:39+00:00",
        "AssumeRolePolicyDocument": {
            "Version": "2012-10-17",
            "Statement": [
                {
                    "Effect": "Allow",
                    "Principal": {
                        "AWS": "arn:aws:iam::014498641650:root"
                    },
                    "Action": "sts:AssumeRole",
                    "Condition": {
                        "ArnEquals": {
                            "aws:PrincipalArn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765969997529-Mary"
                        }
                    }
                }
            ]
        },
        "Description": "Assumable role for internal support",
        "MaxSessionDuration": 3600
    }
]
```

To know about the policies of a particular role : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-role-policies --role-name SupportRole --profile cybr
{
    "PolicyNames": [
        "AllowS3FullAccessForRole"
    ]
}
```

To know about the Actions, Effects and Resources accessible under that policy in that role : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-role-policy --role-name SupportRole --policy-name AllowS3FullAccessForRole --profile cybr
{
    "RoleName": "SupportRole",
    "PolicyName": "AllowS3FullAccessForRole",
    "PolicyDocument": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Action": [
                    "s3:*"
                ],
                "Resource": "*",
                "Effect": "Allow",
                "Sid": "AllowS3FullAccess"
            }
        ]
    }
}
```

