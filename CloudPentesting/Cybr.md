# IAM Enumeration with AWS CLI
In this lab we need to enumerate all the possible information that can be gathered.

At first we will configure the user account to CLI using the command : `aws configure --profile <username>`

User Info Gathering : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws sts get-caller-identity --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
    "Account": "014498641650",
    "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel"
}
```

To get User Creation Date :
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-user --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "User": {
        "Path": "/",
        "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
        "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
        "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
        "CreateDate": "2025-12-17T09:35:05+00:00",
        "Tags": [
            {
                "Key": "cybr-lab",
                "Value": "auto-deployed"
            }
        ]
    }
}
```

To get information of all the users linked to that account : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-users --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "Users": [
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Chris",
            "UserId": "AIDAQGYBPW3ZNFRBOE6G7",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Chris",
            "CreateDate": "2025-12-17T09:35:07+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mary",
            "UserId": "AIDAQGYBPW3ZEZSS7HKW6",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mary",
            "CreateDate": "2025-12-17T09:35:07+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "UserId": "AIDAQGYBPW3ZPPWDR4CSQ",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To get information regarding the Access Keys : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-access-keys --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "AccessKeyMetadata": [
        {
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "AccessKeyId": "AKIAQGYBPW3ZGI5VTUFA",
            "Status": "Active",
            "CreateDate": "2025-12-17T09:35:41+00:00"
        }
    ]
}
```

To get policies mapped in by User : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-user-policies --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "PolicyNames": [
        "AllowEnumerateRoles"
    ]
}
```

To know about the allowed Actions, Resources and Effects : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-user-policy --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --policy-name AllowEnumerateRoles --profile introduction-to-aws-iam-enumeration-1765964100680-Joel
{
    "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
    "PolicyName": "AllowEnumerateRoles",
    "PolicyDocument": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Action": [
                    "iam:GetRole",
                    "iam:GetRolePolicy",
                    "iam:ListRoles",
                    "iam:ListRolePolicies"
                ],
                "Resource": "*",
                "Effect": "Allow"
            }
        ]
    }
}
```

To know about the groups in which the profile is enrolled in : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$  aws iam list-groups --profile introduction-to-aws-iam-enumeration-1765964100680-Joel 
{
    "Groups": [
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Infrastructure",
            "GroupId": "AGPAQGYBPW3ZHIBR3EZYV",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Infrastructure",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To know about the groups in which a particular user is present is : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam list-groups-for-user --user-name introduction-to-aws-iam-enumeration-1765964100680-Joel --profile introduction-to-aws-iam-enumeration-1765964100680-Joel
{
    "Groups": [
        {
            "Path": "/",
            "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
            "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ]
}
```

To know about the users present in that group : 
```
┌──(shibushivansh㉿shibu)-[~]
	└─$ aws iam get-group --group-name introduction-to-aws-iam-enumeration-1765964100680-Developers --profile introduction-to-aws-iam-enumeration-1765964100680-Joel                                 
{
    "Users": [
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "UserId": "AIDAQGYBPW3ZOFFY6ERIP",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        },
        {
            "Path": "/",
            "UserName": "introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "UserId": "AIDAQGYBPW3ZPPWDR4CSQ",
            "Arn": "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike",
            "CreateDate": "2025-12-17T09:35:05+00:00"
        }
    ],
    "Group": {
        "Path": "/",
        "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
        "GroupId": "AGPAQGYBPW3ZCDYU6LXWS",
        "Arn": "arn:aws:iam::014498641650:group/introduction-to-aws-iam-enumeration-1765964100680-Developers",
        "CreateDate": "2025-12-17T09:35:05+00:00"
    }
}
```

To know the policies in which users of the group are bind into : 
```

```

To know about the Actions, Effects and Resources of the Group Policies : 
```
┌──(shibushivansh㉿shibu)-[~]
└─$ aws iam get-group-policy --group-name introduction-to-aws-iam-enumeration-1765964100680-Developers --policy-name introduction-to-aws-iam-enumeration-1765964100680-devs-policy --profile introduction-to-aws-iam-enumeration-1765964100680-Joel   
{
    "GroupName": "introduction-to-aws-iam-enumeration-1765964100680-Developers",
    "PolicyName": "introduction-to-aws-iam-enumeration-1765964100680-devs-policy",
    "PolicyDocument": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Action": [
                    "iam:ListAccessKeys"
                ],
                "Resource": [
                    "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Joel",
                    "arn:aws:iam::014498641650:user/introduction-to-aws-iam-enumeration-1765964100680-Mike"
                ],
                "Effect": "Allow"
            },
            {
                "Action": [
                    "iam:ListGroupPolicies",
                    "iam:ListAttachedPolicies",
                    "iam:ListPolicyVersions",
                    "iam:ListUserPolicies",
                    "iam:ListAttachedUserPolicies",
                    "iam:ListUsers",
                    "iam:ListGroups",
                    "iam:ListGroupsForUser",
                    "iam:GetPolicy",
                    "iam:GetPolicyVersion",
                    "iam:GetUser",
                    "iam:GetUserPolicy",
                    "iam:GetGroupPolicy",
                    "iam:GetGroup",
                    "iam:ListAttachedGroupPolicies"
                ],
                "Resource": "*",
                "Effect": "Allow"
            }
        ]
    }
}
```

To know a detailed information about roles under a profiles :
```

```